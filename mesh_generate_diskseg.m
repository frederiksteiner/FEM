function m = mesh_generate_diskseg()

m.C = [1, 2, 6; ...
       2, 3, 4; ...
       6, 4, 7; ...
       4, 5, 5];
m.P = [1, 2, 3];
m.K = [1, 1, 1];
m.B = [2, 2, 0, 1, 0, 2, 0];
m.V = [-1, 1, -1, 1; ...
       -1, -1, 1, 1];
m.R = [1, 2, 3, 4]';
f1 = @(x,y) [(1 + x)*(0.225 - 0.025*y); ...
             (1 + y)*(0.225 - 0.025*x)];
f2 = @(x,y) [(1-x)*(0.225-0.025*y) + 0.5*(1 + x) *cos((1 + y)*pi/8);...
             (1-x)*(0.1 + 0.1*y) + 0.5*(1 + x)*sin((1 +y)*pi/8)];
f3 = @(x,y) [(1-y)*(0.1 + 0.1*x) + 0.5*(1 + y)*sin((1 + x)*pi/8); ...
             (1-y)*(0.225-0.025*x) + 0.5*(1 +y)*cos((1 +x)*pi/8)];
m.M = {f1, f2, f3};
% J1 = @(x,y) [0.225 - 0.025*y, -0.025*(1+x); ...
%              0.225 - 0.025*x, -0.025*(1+y)];
% J2 = @(x,y) [-(0.225 - 0.025*y) + 0.5*cos((1+y)*pi/8), -0.025*(1 - x) - 1/16*pi*(1 + x)*sin((1 + y)*pi/8);...
%              -(0.1 + 0.1*y) + 0.5*sin((1 + y)*pi/8), 0.1*(1 - x) + pi/16*(1 + x)*cos((1 + y)*pi/8)];
% J3 = @(x,y) [0.1*(1 - y) + pi/16*(1 + y)*cos((1 + x)*pi/8), -(0.1 + 0.1*x) + 0.5*sin((1 + x)*pi/8);...
%              -0.025*(1 - y) - 1/16*pi*(1 + x)*sin((1 + x)*pi/8), -(0.225 - 0.025*x) + 0.5*cos((1+x)*pi/8)];
% m.J = {J1, J2, J3};
m.refLevel = 0;
m.J = cell(1,3);
m.J{1} = @(x,y) [0.225 - 0.025*y, -(1+x)*0.025;
            -(1+y)*0.025,    0.225 - 0.025*x];
        
m.J{2} = @(x,y) [-(0.225 - 0.025*y) + 0.5 * cos((1+y)*pi/8), ...
                -0.025*(1-x) - 0.5*(1+x)*sin((1+y)*pi/8)*pi/8;
            -(0.1 + 0.1*y) + 0.5*sin((1+y)*pi/8), ...
                0.1*(1-x) + 0.5*(1+x)*cos((1+y)*pi/8)*pi/8];
            
m.J{3} = @(x,y) [0.1*(1-y) + 0.5*(1+y)*cos((1+x)*pi/8)*pi/8, ...
                -(0.1+0.1*x) + 0.5*sin((1+x)*pi/8);
            -0.025*(1-y) - 0.5*(1+y)*sin((1+x)*pi/8)*pi/8, ...
                -(0.225 - 0.025*x) + 0.5*cos((1+x)*pi/8)];

end
             
             
             
             
             
             